import{d as R,_ as de,o as t,h as w,w as i,i as ee,n as be,l as Me,u as e,aQ as ke,g as z,B as ze,e as d,m as ue,j as pe,aR as Be,aS as Oe,c as u,a as f,$ as S,az as Ae,ae as E,aA as Fe,aJ as j,aT as te,b as m,t as v,r as H,aU as J,F as A,aV as Q,T as Le,a3 as _e,ad as ne,aO as Ge,aa as D,aW as re,aX as De,aY as Re,aZ as K,a_ as He,a$ as Te,ag as le}from"./index-D6ptrN7G.js";import{b as he,d as fe,e as Z,f as b,c as ge,g as me,S as q,R as ce,i as Ee}from"./PlayerFlagship.vue_vue_type_script_setup_true_lang-Crbn3Kv0.js";import{C as je,O as Ie,m as Ve}from"./SystemDialog.vue_vue_type_script_setup_true_lang-B_Aiswa8.js";const I=R({__name:"DropdownMenuSub",props:{defaultOpen:{type:Boolean},open:{type:Boolean}},emits:["update:open"],setup(n,{emit:o}){const y=de(n,o);return($,P)=>(t(),w(e(ke),be(Me(e(y))),{default:i(()=>[ee($.$slots,"default")]),_:3},16))}}),V=R({__name:"DropdownMenuSubTrigger",props:{disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{}},setup(n){const o=n,a=z(()=>{const{class:y,...$}=o;return $}),h=ze(a);return(y,$)=>(t(),w(e(Be),ue(e(h),{class:e(pe)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",o.class)}),{default:i(()=>[ee(y.$slots,"default"),d(e(je),{class:"ml-auto h-4 w-4"})]),_:3},16,["class"]))}}),U=R({__name:"DropdownMenuSubContent",props:{forceMount:{type:Boolean},loop:{type:Boolean},sideOffset:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus"],setup(n,{emit:o}){const a=n,h=o,y=z(()=>{const{class:P,...M}=a;return M}),$=de(y,h);return(P,M)=>(t(),w(e(Oe),ue(e($),{class:e(pe)("z-50 min-w-32 overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a.class)}),{default:i(()=>[ee(P.$slots,"default")]),_:3},16,["class"]))}}),Ue="/Arcs-CAT/assets/board-2-CAuHClGw.jpg",Xe={xmlns:"http://www.w3.org/2000/svg",width:"996",height:"923"},Ye=f("path",{fill:"transparent",d:"M565.5 923c40.5-36 346.5-103.5 426-85.5L996 .5 0 2z"},null,-1),Ne=[Ye];function We(n,o){return t(),u("svg",Xe,[...Ne])}const Ke={render:We},qe={xmlns:"http://www.w3.org/2000/svg",width:"959",height:"937"},Je=f("path",{fill:"transparent",d:"M.5 837.5c90-16.5 396 52.5 453 99L959 2 2 .5z"},null,-1),Qe=[Je];function Ze(n,o){return t(),u("svg",qe,[...Qe])}const et={render:Ze},tt={xmlns:"http://www.w3.org/2000/svg",width:"1678",height:"1100"},nt=f("path",{fill:"transparent",d:"M.5 939C41 942 200 1060.5 227 1099.5L1677.51 0H504.5z"},null,-1),st=[nt];function ot(n,o){return t(),u("svg",tt,[...st])}const it={render:ot},at={xmlns:"http://www.w3.org/2000/svg",width:"1142",height:"596"},rt=f("path",{fill:"transparent",d:"M153 459.5c270-94.5 552-12 712.5 136.5l276-315C873-10 315-76 0 90.5z"},null,-1),lt=[rt];function ct(n,o){return t(),u("svg",at,[...lt])}const dt={render:ct},ut={xmlns:"http://www.w3.org/2000/svg",width:"1772",height:"1333"},pt=f("path",{fill:"transparent",d:"M.13 1133.95c19.17-4.3 180.54 194.65 160.88 199.06L1771.22 707.2 1412.64.95z"},null,-1),_t=[pt];function ht(n,o){return t(),u("svg",ut,[..._t])}const ft={render:ht},gt={xmlns:"http://www.w3.org/2000/svg",width:"1601",height:"889"},mt=f("path",{fill:"transparent",d:"M0 620c34 42 74 194 74 268-.08 11.31 1525.86-209.02 1526.01-230l-4-658z"},null,-1),vt=[mt];function $t(n,o){return t(),u("svg",gt,[...vt])}const wt={render:$t},yt={xmlns:"http://www.w3.org/2000/svg",width:"1518",height:"654"},Ct=f("path",{fill:"transparent",d:"m0 226 4 198c8.51-14.36 202.01 52 250.01 76l1238 154 26-654C1512.76 35.5-3.26 248.05 0 226"},null,-1),xt=[Ct];function Pt(n,o){return t(),u("svg",yt,[...xt])}const St={render:Pt},bt={xmlns:"http://www.w3.org/2000/svg",width:"597",height:"678"},Mt=f("path",{fill:"transparent",d:"M348 0 0 226c66 28 188 362 152 430l134 22c60-50 299.14-37.12 306-22 26-230-68-556-244-656"},null,-1),kt=[Mt];function zt(n,o){return t(),u("svg",bt,[...kt])}const Bt={render:zt},Ot={xmlns:"http://www.w3.org/2000/svg",width:"1538",height:"819"},At=f("path",{fill:"transparent",d:"M62.35 18.63C68.54 32.44 3.44 237.91.17 230.61l1526.3 587.9 11.3-668.45L322.4.26c.07 10.97-259.94 33.63-260.05 18.37"},null,-1),Ft=[At];function Lt(n,o){return t(),u("svg",Ot,[...Ft])}const Gt={render:Lt},Dt={xmlns:"http://www.w3.org/2000/svg",width:"1722",height:"1325"},Rt=f("path",{fill:"transparent",d:"M172.76.61C185.38 11.55 9.75 263.15.34 254.99L1327.37 1324.8l394.3-727.81z"},null,-1),Ht=[Rt];function Tt(n,o){return t(),u("svg",Dt,[...Ht])}const Et={render:Tt},jt={xmlns:"http://www.w3.org/2000/svg",width:"1540",height:"1100"},It=f("path",{fill:"transparent",d:"M241.17.41C247.9 10.53 7.49 165.72.92 155.85l589.32 944.04 949.7-46.64z"},null,-1),Vt=[It];function Ut(n,o){return t(),u("svg",jt,[...Vt])}const Xt={render:Ut},Yt={xmlns:"http://www.w3.org/2000/svg",width:"715",height:"718"},Nt=f("path",{fill:"transparent",d:"M287.73.12C325.89 106.11 72.92 381.69.84 407.13L60.2 507.47c96.1-5.66 144.15 149.79 185.13 210.56C539.28 588.02 701.81 315.27 714.52 96.22c-.22 14.74-285.47-24.03-299.6-77.73z"},null,-1),Wt=[Nt];function Kt(n,o){return t(),u("svg",Yt,[...Wt])}const qt={render:Kt},Jt={xmlns:"http://www.w3.org/2000/svg",width:"948",height:"867"},Qt=f("path",{fill:"transparent",d:"M433.1.27C424.62 32.78 47.29 110.51 3.48 80.83L.65 863.76l946.87 2.82z"},null,-1),Zt=[Qt];function en(n,o){return t(),u("svg",Jt,[...Zt])}const tn={render:en},nn={xmlns:"http://www.w3.org/2000/svg",width:"907",height:"883"},sn=f("path",{fill:"transparent",d:"M905.24 97.83C885.45 116.2 460.07 31.41 454.42.32L.77 868.04l905.88 14.13z"},null,-1),on=[sn];function an(n,o){return t(),u("svg",nn,[...on])}const rn={render:an},ln={xmlns:"http://www.w3.org/2000/svg",width:"1534",height:"1090"},cn=f("path",{fill:"transparent",d:"M1533.77 213.66c-36.75 8.48-247.32-176.64-269.93-213.38L.41 1013.55l1085.36 76.32z"},null,-1),dn=[cn];function un(n,o){return t(),u("svg",ln,[...dn])}const pn={render:un},_n={xmlns:"http://www.w3.org/2000/svg",width:"1168",height:"607"},hn=f("path",{fill:"transparent",d:"M1018.02 143.13C931.81 234.99 338.25 155.85 259.11.39L120.62 99.32C151.71 157.26 20.28 273.14.49 287.28c244.49 340.57 871.96 392.86 1167.33 230.34-29.68-57.94-171-207.73-105.99-262.85z"},null,-1),fn=[hn];function gn(n,o){return t(),u("svg",_n,[...fn])}const mn={render:gn},vn={xmlns:"http://www.w3.org/2000/svg",width:"1625",height:"1329"},$n=f("path",{fill:"transparent",d:"M1624.11 171.31c-3.45 16.97-138.61-156.52-135.67-171L.31 603.75l193.61 724.98z"},null,-1),wn=[$n];function yn(n,o){return t(),u("svg",vn,[...wn])}const Cn={render:yn},xn={xmlns:"http://www.w3.org/2000/svg",width:"1492",height:"821"},Pn=f("path",{fill:"transparent",d:"M1491.85 246.31c-12.56 6.09-84.79-230.36-87.62-245.9L.9 181.3l48.05 638.77z"},null,-1),Sn=[Pn];function bn(n,o){return t(),u("svg",xn,[...Sn])}const Mn={render:bn},kn={xmlns:"http://www.w3.org/2000/svg",width:"1432",height:"597"},zn=f("path",{fill:"transparent",d:"M1431.89 418.82c-10.34 1.6-17.4-199.52-9.9-200.68-42.39 2.83-254.38-29.68-319.39-80.55L7.35.5.29 596.89z"},null,-1),Bn=[zn];function On(n,o){return t(),u("svg",kn,[...Bn])}const An={render:On},Fn={xmlns:"http://www.w3.org/2000/svg",width:"571",height:"629"},Ln=f("path",{fill:"transparent",d:"M570.53 420.56c-63.6-39.57-155.46-329.28-125.78-402.77L314.73.83C224.28 50.3 40.56 27.69 2.41 14.97c-12.72 145.56 21.2 428.21 224.7 613.34 29.68-15.55 132.84-127.19 204.92-108.82z"},null,-1),Gn=[Ln];function Dn(n,o){return t(),u("svg",Fn,[...Gn])}const Rn={render:Dn},Hn={xmlns:"http://www.w3.org/2000/svg",width:"1432",height:"799"},Tn=f("path",{fill:"transparent",d:"M1370.86 777.8c-9.38.35 54.91-210.35 60.77-210.57L.03.52l36.74 664.22L1065.6 799c46.64-40.98 223.29-36.74 305.26-21.2"},null,-1),En=[Tn];function jn(n,o){return t(),u("svg",Hn,[...En])}const In={render:jn},Vn={xmlns:"http://www.w3.org/2000/svg",width:"1695",height:"1280"},Un=f("path",{fill:"transparent",d:"M1512.63 1279.82c-11.3-29.68 154.04-245.91 182.31-262.86L441.4.84.48 683.43z"},null,-1),Xn=[Un];function Yn(n,o){return t(),u("svg",Vn,[...Xn])}const Nn={render:Yn},Wn={xmlns:"http://www.w3.org/2000/svg",width:"1433",height:"1089"},Kn=f("path",{fill:"transparent",d:"M1200.35 1088.78c5.31-21.04 196.44-161.11 231.77-166.76L897.92.6.52 110.83z"},null,-1),qn=[Kn];function Jn(n,o){return t(),u("svg",Wn,[...qn])}const Qn={render:Jn},Zn={xmlns:"http://www.w3.org/2000/svg",width:"755",height:"752"},es=f("path",{fill:"transparent",d:"M.04 648.04C25.47 448.78 214.85 119.49 489.01.78c107.41 33.92-72.07 189.37 180.9 183.72l84.79 141.32c-86.21 26.86-282.65 336.35-292.54 425.39l-130.02-18.38c11.31-40.98-285.47-77.72-332.1-84.79"},null,-1),ts=[es];function ns(n,o){return t(),u("svg",Zn,[...ts])}const ss={render:ns},os={"1A":Ke,"1C":et,"1H":it,"1G":dt,"2A":ft,"2C":wt,"2H":St,"2G":Bt,"3A":Gt,"3C":Et,"3H":Xt,"3G":qt,"4A":tn,"4C":rn,"4H":pn,"4G":mn,"5A":Cn,"5C":Mn,"5H":An,"5G":Rn,"6A":In,"6C":Nn,"6H":Qn,"6G":ss},is=R({props:{position:{type:Object,required:!0,default(){return{x:0,y:0}}},systemConfig:{type:Object,required:!0}},emits:["click","mounted"],setup(n,{emit:o,attrs:a}){var k;const h=(k=os[n.systemConfig.id])==null?void 0:k.render(),y=S(),$=S(),P=S(),M=S(),B=function(s){o("click",n.systemConfig.id,s)};Ae(()=>{o("mounted",{el:P.value??y.value,shape:$.value,bounds:M.value})});const L=()=>{var s;return E(h.type,{...h.props,ref:y,...a,style:{pointerEvents:"none",scale:n.systemConfig.scale,left:`${n.systemConfig.position.x}px`,top:`${n.systemConfig.position.y}px`,transformOrigin:"center",transform:"translate(-50%, -50%)"},"data-system-id":n.systemConfig.id},(s=h.children)==null?void 0:s.map(g=>E(g.type,{ref:$,style:{pointerEvents:"all"},onClick:r=>{B(r)},...g.props})))};return n.systemConfig.bounds?()=>{var s;return[E(h.type,{...h.props,ref:P,...a,style:{pointerEvents:"none",scale:n.systemConfig.scale*n.systemConfig.bounds.scale,left:`${n.systemConfig.position.x}px`,top:`${n.systemConfig.position.y}px`,transform:`translate(-${n.systemConfig.bounds.position.x}px, -${n.systemConfig.bounds.position.y}px) translate(-50%, -50%)`},"data-system-id":`${n.systemConfig.id}-bounds`},(s=h.children)==null?void 0:s.map(g=>E(g.type,{ref:M,style:{pointerEvents:"all"},...g.props}))),E(L)]}:L}}),as=R({__name:"GameBoardMenu",props:{activeSystem:{},isOpen:{type:Boolean},isFull:{type:Boolean},pointerPosition:{}},emits:["update","select","close"],setup(n,{emit:o}){const a=n,h=o,y=Fe(),$=z(()=>y.players.length>0?y.players.map(s=>s.color):Object.values(j).filter(s=>s!==j.free&&s!==j.empire)),P=$.value.concat(j.free),M=$.value.concat(j.empire),B=z(()=>({left:`${a.pointerPosition.x}px`,top:`${a.pointerPosition.y}px`}));function L(s){h("update",s)}function k(s,g){h("select",s,g),h("close")}return(s,g)=>(t(),w(e(me),{open:s.isOpen,"onUpdate:open":L},{default:i(()=>[d(e(he),{class:"fixed dropdown-trigger",style:te(B.value)},null,8,["style"]),d(e(ge),null,{default:i(()=>[d(e(Ie),{options:{ignore:[".system-dialog"]},onTrigger:g[2]||(g[2]=r=>h("close"))},{default:i(()=>[d(e(fe),null,{default:i(()=>[m(v(s.$t("system_id",{id:s.activeSystem})),1)]),_:1}),d(e(Z)),d(e(I),null,{default:i(()=>[d(e(V),null,{default:i(()=>[m(v(s.$t("system_menu.add_ship")),1)]),_:1}),d(e(U),null,{default:i(()=>[(t(!0),u(A,null,H(e(M),r=>(t(),w(e(b),{key:r,onSelect:l=>k(e(J).ship,r)},{default:i(()=>[m(v(s.$t(`colors.${r}`)),1)]),_:2},1032,["onSelect"]))),128))]),_:1})]),_:1}),d(e(I),null,{default:i(()=>[d(e(V),null,{default:i(()=>[m(v(s.$t("system_menu.add_flagship")),1)]),_:1}),d(e(U),null,{default:i(()=>[(t(!0),u(A,null,H($.value,r=>(t(),w(e(b),{key:r,onSelect:l=>k(e(J).flagship,r)},{default:i(()=>[m(v(s.$t(`colors.${r}`)),1)]),_:2},1032,["onSelect"]))),128))]),_:1})]),_:1}),d(e(I),null,{default:i(()=>[d(e(V),{class:"data-[disabled]:opacity-50",disabled:s.isFull},{default:i(()=>[m(v(s.$t("system_menu.add_city")),1)]),_:1},8,["disabled"]),d(e(U),null,{default:i(()=>[(t(!0),u(A,null,H(e(P),r=>(t(),w(e(b),{key:r,onSelect:l=>k(e(Q).city,r)},{default:i(()=>[m(v(s.$t(`colors.${r}`)),1)]),_:2},1032,["onSelect"]))),128))]),_:1})]),_:1}),d(e(I),null,{default:i(()=>[d(e(V),{class:"data-[disabled]:opacity-50",disabled:s.isFull},{default:i(()=>[m(v(s.$t("system_menu.add_starport")),1)]),_:1},8,["disabled"]),d(e(U),null,{default:i(()=>[(t(!0),u(A,null,H(e(P),r=>(t(),w(e(b),{key:r,onSelect:l=>k(e(Q).starport,r)},{default:i(()=>[m(v(s.$t(`colors.${r}`)),1)]),_:2},1032,["onSelect"]))),128))]),_:1})]),_:1}),d(e(I),null,{default:i(()=>[d(e(V),null,{default:i(()=>[m(v(s.$t("system_menu.add_token")),1)]),_:1}),d(e(U),null,{default:i(()=>[(t(!0),u(A,null,H(e(Le),r=>(t(),w(e(b),{key:r,onSelect:l=>k(r)},{default:i(()=>[m(v(s.$t(`pieces.${r}`)),1)]),_:2},1032,["onSelect"]))),128))]),_:1})]),_:1}),d(e(Z)),d(Ve,{"system-id":s.activeSystem,onConfirm:g[1]||(g[1]=r=>s.$emit("close"))},{default:i(()=>[d(e(b),{onSelect:g[0]||(g[0]=_e(()=>{},["prevent"]))},{default:i(()=>[m(v(s.$t("system_menu.configure")),1)]),_:1})]),_:1},8,["system-id"])]),_:1})]),_:1})]),_:1},8,["open"]))}}),rs=ne(as,[["__scopeId","data-v-4db67800"]]),ls=R({__name:"GamePieceMenu",props:{activePiece:{},isOpen:{type:Boolean},pointerPosition:{}},emits:["update","add","remove","flip","preview"],setup(n,{emit:o}){const a=n,h=o,{t:y}=Ge(),$=z(()=>({left:`${a.pointerPosition.x}px`,top:`${a.pointerPosition.y}px`})),P=z(()=>{const l=y(`colors.${a.activePiece.color}`),x=y(`pieces.${a.activePiece.type}`,"group"in a.activePiece?2:1),O=a.activePiece.color?`${l} ${x}`:x;return`${O.charAt(0).toUpperCase()}${O.slice(1).toLowerCase()}`}),M=z(()=>"group"in a.activePiece?a.activePiece.group.fresh.length>0:a.activePiece.isFresh),B=z(()=>"group"in a.activePiece?a.activePiece.group.damaged.length>0:!a.activePiece.isFresh);function L(l){h("update",l)}function k(){a.activePiece.color?h("add",a.activePiece.type,a.activePiece.color):h("add",a.activePiece.type)}function s(l=!0){h("remove",l)}function g(l=!0){h("flip",l)}function r(){h("preview")}return(l,x)=>(t(),w(e(me),{open:l.isOpen,"onUpdate:open":L},{default:i(()=>[d(e(he),{class:"fixed dropdown-trigger",style:te($.value)},null,8,["style"]),d(e(ge),null,{default:i(()=>[d(e(fe),null,{default:i(()=>[m(v(P.value),1)]),_:1}),d(e(Z)),"group"in l.activePiece?(t(),u(A,{key:0},[d(e(b),{onSelect:k},{default:i(()=>[d(e(q),{class:"mr-2",size:16}),m(" "+v(l.$t("piece_menu.add")),1)]),_:1}),M.value?(t(),w(e(b),{key:0,onSelect:x[0]||(x[0]=O=>g(!0))},{default:i(()=>[d(e(q),{class:"mr-2",size:16}),m(" "+v(l.$t("piece_menu.damage_fresh")),1)]),_:1})):D("",!0),M.value?(t(),w(e(b),{key:1,onSelect:x[1]||(x[1]=O=>s(!0))},{default:i(()=>[d(e(q),{class:"mr-2",size:16}),m(" "+v(l.$t("piece_menu.remove_fresh")),1)]),_:1})):D("",!0),B.value?(t(),w(e(b),{key:2,onSelect:x[2]||(x[2]=O=>g(!1))},{default:i(()=>[d(e(ce),{class:"mr-2",size:16}),m(" "+v(l.$t("piece_menu.repair_damaged")),1)]),_:1})):D("",!0),B.value?(t(),w(e(b),{key:3,onSelect:x[3]||(x[3]=O=>s(!1))},{default:i(()=>[d(e(ce),{class:"mr-2",size:16}),m(" "+v(l.$t("piece_menu.remove_damaged")),1)]),_:1})):D("",!0)],64)):(t(),u(A,{key:1},[e(re)(l.activePiece.type)?D("",!0):(t(),w(e(b),{key:0,onSelect:x[4]||(x[4]=O=>g(l.activePiece.isFresh))},{default:i(()=>[m(v(l.activePiece.isFresh?l.$t("piece_menu.damage"):l.$t("piece_menu.repair")),1)]),_:1})),e(re)(l.activePiece.type)?(t(),w(e(b),{key:1,onSelect:x[5]||(x[5]=O=>r())},{default:i(()=>[m(v(l.$t("common.view")),1)]),_:1})):D("",!0),d(e(b),{onSelect:s},{default:i(()=>[m(v(l.$t("piece_menu.remove")),1)]),_:1})],64))]),_:1})]),_:1},8,["open"]))}}),cs=ne(ls,[["__scopeId","data-v-2cfc945f"]]),ds=["src"],us=R({__name:"GameBoard",setup(n){const o=De();o.pause(),Re({type:"movement",eventFilter:o.eventFilter});const a=K({x:0,y:0}),h=K({x:0,y:0}),y=K({x:0,y:0}),$=S(),P=S({x:0,y:0}),M=z(()=>({width:"max-content",transform:`translate(${h.x}px, ${h.y}px)`})),B=S();function L(_,p){var C;const c=(C=B.value)==null?void 0:C.getBoundingClientRect();_.position.x=p.clientX-P.value.x+c.x*-1,_.position.y=p.clientY-P.value.y+c.y*-1,$.value=void 0}function k(_,p){var C;const c=(C=p.target)==null?void 0:C.getBoundingClientRect();$.value=_,P.value={x:p.clientX-c.x-c.width/2,y:p.clientY-c.y-c.height/2}}const s=S(!1),g=S(!1),r=S(),l=S(),x=z(()=>r.value?F.systemUi(r.value,"position"):void 0);function O(_,p){var C;let c=((C=p.target)==null?void 0:C.getBoundingClientRect())??{x:0,y:0};y.x=c.x,y.y=c.y,a.x=p.clientX,a.y=p.clientY,r.value=_,s.value=!0}function ve(_){setTimeout(()=>{g.value=_})}function $e(){setTimeout(()=>{s.value=!1,r.value=void 0})}const we=S(!0),F=He(),ye=z(()=>{if(!we.value)return F.pieces;const _=new Map;return F.pieces.forEach(p=>{const c=`${p.system} ${p.color} ${p.type}`;if(Object.values(Q).includes(p.type)||p.type===J.flagship){_.set(c+p.id,p);return}const C=["system","type","color","position"];_.has(c)||_.set(c,le.transform(p,(N,W,T)=>{C.includes(T)&&(N[T]=W)},{group:{damaged:[],fresh:[]}}));const G=["id","isFresh"],ae=_.get(c),Y=le.transform(p,(N,W,T)=>{G.includes(T)&&(N[T]=W)},{isFresh:!0});Y.isFresh?ae.group.fresh.push(Y):ae.group.damaged.push(Y)}),Array.from(_.values())});function Ce(_,p,c){a.x=c.clientX,a.y=c.clientY,l.value=_,X.value=p,r.value=_.system,g.value=!0}function se(_,p){if(!r.value)return;let{x:c,y:C}=B.value.getBoundingClientRect();F.addPiece(r.value,{type:_,color:p},{x:a.x-c,y:a.y-C})}function xe(_){l.value&&F.removePiece(l.value,_)}function Pe(_){l.value&&F.flipPiece(l.value,_)}function Se(_){$.value&&F.movePiece($.value,_)}const X=S(-1),oe=S(!1);function ie(_){X.value=_?X.value:-1,oe.value=_}return(_,p)=>(t(),u(A,null,[f("div",{ref_key:"wrapperEl",ref:B,id:"game-wrapper",class:"select-none",style:te(M.value)},[f("img",{src:e(Ue),alt:"Arcs",class:"max-w-max",draggable:"false"},null,8,ds),(t(!0),u(A,null,H(e(Te),c=>(t(),w(e(is),{key:c.id,"system-config":c,position:c.position,class:"absolute system",draggable:"false",onClick:O,onMounted:C=>e(F).setSystemUi(c.id,C),onDragover:p[0]||(p[0]=_e(()=>{},["prevent","stop"])),onDrop:C=>Se(c.id)},null,8,["system-config","position","onMounted","onDrop"]))),128)),(t(!0),u(A,null,H(ye.value,(c,C)=>(t(),w(Ee,{key:`${c.type}${c.color?`-${c.color}`:""}-${c.system}`,"piece-config":c,"system-position":x.value,"open-preview":oe.value&&X.value===C,draggable:"false",onClick:G=>Ce(c,C,G),onDragstart:G=>k(c,G),onDragend:G=>L(c,G),onPreviewClose:p[1]||(p[1]=G=>ie(!1))},null,8,["piece-config","system-position","open-preview","onClick","onDragstart","onDragend"]))),128))],4),r.value?(t(),w(rs,{key:0,"active-system":r.value,"is-open":s.value,"is-full":e(F).isSystemFull(r.value),"pointer-position":a,onSelect:se,onClose:$e},null,8,["active-system","is-open","is-full","pointer-position"])):D("",!0),l.value?(t(),w(cs,{key:1,"active-piece":l.value,"is-open":g.value,"pointer-position":a,onAdd:se,onRemove:xe,onFlip:Pe,onUpdate:ve,onPreview:p[2]||(p[2]=c=>ie(!0))},null,8,["active-piece","is-open","pointer-position"])):D("",!0)],64))}}),ps={class:"relative viewport"},_s=R({__name:"CampaignView",setup(n){return(o,a)=>(t(),u("main",ps,[d(us)]))}}),ms=ne(_s,[["__scopeId","data-v-6cb69da6"]]);export{ms as default};
