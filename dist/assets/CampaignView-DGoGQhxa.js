import{f as Q,d as F,x as me,o as n,h as S,w as r,i as ee,n as Le,l as Ae,u as t,aK as Be,g as A,q as De,e as a,m as fe,j as ge,aL as Ge,aM as Oe,c as d,a as v,_ as L,ao as Fe,ab as T,ap as Re,az as E,al as te,b as w,t as $,r as R,aN as Z,F as D,aO as le,T as Ie,a2 as ve,aa as ye,aD as He,a9 as O,aP as ue,aI as Te,aQ as Ee,ai as je,aR as qe,aS as Ue,a8 as K,aJ as Ve,aT as Xe,aU as I,aV as Ne,aW as Ye,aX as Ke,ad as de}from"./index-CbcyyI3W.js";import{_ as he,b as we,c as J,d as b,a as $e,e as _e,S as W,R as ce,g as We}from"./DropdownMenuLabel.vue_vue_type_script_setup_true_lang-D-_oyymu.js";import{C as Ze,O as Ce,q as Je}from"./SystemDialog.vue_vue_type_script_setup_true_lang-D6wzMRCx.js";/**
 * @license lucide-vue-next v0.406.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=Q("ListCollapseIcon",[["path",{d:"m3 10 2.5-2.5L3 5",key:"i6eama"}],["path",{d:"m3 19 2.5-2.5L3 14",key:"w2gmor"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}]]);/**
 * @license lucide-vue-next v0.406.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=Q("ZoomInIcon",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-vue-next v0.406.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=Q("ZoomOutIcon",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),j=F({__name:"DropdownMenuSub",props:{defaultOpen:{type:Boolean},open:{type:Boolean}},emits:["update:open"],setup(s,{emit:e}){const h=me(s,e);return(x,M)=>(n(),S(t(Be),Le(Ae(t(h))),{default:r(()=>[ee(x.$slots,"default")]),_:3},16))}}),q=F({__name:"DropdownMenuSubTrigger",props:{disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{}},setup(s){const e=s,f=A(()=>{const{class:h,...x}=e;return x}),g=De(f);return(h,x)=>(n(),S(t(Ge),fe(t(g),{class:t(ge)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",e.class)}),{default:r(()=>[ee(h.$slots,"default"),a(t(Ze),{class:"ml-auto h-4 w-4"})]),_:3},16,["class"]))}}),U=F({__name:"DropdownMenuSubContent",props:{forceMount:{type:Boolean},loop:{type:Boolean},sideOffset:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus"],setup(s,{emit:e}){const f=s,g=e,h=A(()=>{const{class:M,...k}=f;return k}),x=me(h,g);return(M,k)=>(n(),S(t(Oe),fe(t(x),{class:t(ge)("z-50 min-w-32 overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",f.class)}),{default:r(()=>[ee(M.$slots,"default")]),_:3},16,["class"]))}}),pe="/Arcs-CAT/assets/board-2-CAuHClGw.jpg",nt={xmlns:"http://www.w3.org/2000/svg",width:"996",height:"923"};function st(s,e){return n(),d("svg",nt,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M565.5 923c40.5-36 346.5-103.5 426-85.5L996 .5 0 2z"},null,-1)]))}const ot={render:st},it={xmlns:"http://www.w3.org/2000/svg",width:"959",height:"937"};function rt(s,e){return n(),d("svg",it,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M.5 837.5c90-16.5 396 52.5 453 99L959 2 2 .5z"},null,-1)]))}const at={render:rt},lt={xmlns:"http://www.w3.org/2000/svg",width:"1678",height:"1100"};function ut(s,e){return n(),d("svg",lt,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M.5 939C41 942 200 1060.5 227 1099.5L1677.51 0H504.5z"},null,-1)]))}const dt={render:ut},ct={xmlns:"http://www.w3.org/2000/svg",width:"1142",height:"596"};function pt(s,e){return n(),d("svg",ct,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M153 459.5c270-94.5 552-12 712.5 136.5l276-315C873-10 315-76 0 90.5z"},null,-1)]))}const mt={render:pt},ft={xmlns:"http://www.w3.org/2000/svg",width:"1772",height:"1333"};function gt(s,e){return n(),d("svg",ft,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M.13 1133.95c19.17-4.3 180.54 194.65 160.88 199.06L1771.22 707.2 1412.64.95z"},null,-1)]))}const vt={render:gt},yt={xmlns:"http://www.w3.org/2000/svg",width:"1601",height:"889"};function ht(s,e){return n(),d("svg",yt,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M0 620c34 42 74 194 74 268-.08 11.31 1525.86-209.02 1526.01-230l-4-658z"},null,-1)]))}const wt={render:ht},$t={xmlns:"http://www.w3.org/2000/svg",width:"1518",height:"654"};function _t(s,e){return n(),d("svg",$t,e[0]||(e[0]=[v("path",{fill:"transparent",d:"m0 226 4 198c8.51-14.36 202.01 52 250.01 76l1238 154 26-654C1512.76 35.5-3.26 248.05 0 226"},null,-1)]))}const Ct={render:_t},St={xmlns:"http://www.w3.org/2000/svg",width:"597",height:"678"};function xt(s,e){return n(),d("svg",St,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M348 0 0 226c66 28 188 362 152 430l134 22c60-50 299.14-37.12 306-22 26-230-68-556-244-656"},null,-1)]))}const Pt={render:xt},Mt={xmlns:"http://www.w3.org/2000/svg",width:"1538",height:"819"};function kt(s,e){return n(),d("svg",Mt,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M62.35 18.63C68.54 32.44 3.44 237.91.17 230.61l1526.3 587.9 11.3-668.45L322.4.26c.07 10.97-259.94 33.63-260.05 18.37"},null,-1)]))}const bt={render:kt},zt={xmlns:"http://www.w3.org/2000/svg",width:"1722",height:"1325"};function Lt(s,e){return n(),d("svg",zt,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M172.76.61C185.38 11.55 9.75 263.15.34 254.99L1327.37 1324.8l394.3-727.81z"},null,-1)]))}const At={render:Lt},Bt={xmlns:"http://www.w3.org/2000/svg",width:"1540",height:"1100"};function Dt(s,e){return n(),d("svg",Bt,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M241.17.41C247.9 10.53 7.49 165.72.92 155.85l589.32 944.04 949.7-46.64z"},null,-1)]))}const Gt={render:Dt},Ot={xmlns:"http://www.w3.org/2000/svg",width:"715",height:"718"};function Ft(s,e){return n(),d("svg",Ot,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M287.73.12C325.89 106.11 72.92 381.69.84 407.13L60.2 507.47c96.1-5.66 144.15 149.79 185.13 210.56C539.28 588.02 701.81 315.27 714.52 96.22c-.22 14.74-285.47-24.03-299.6-77.73z"},null,-1)]))}const Rt={render:Ft},It={xmlns:"http://www.w3.org/2000/svg",width:"948",height:"867"};function Ht(s,e){return n(),d("svg",It,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M433.1.27C424.62 32.78 47.29 110.51 3.48 80.83L.65 863.76l946.87 2.82z"},null,-1)]))}const Tt={render:Ht},Et={xmlns:"http://www.w3.org/2000/svg",width:"907",height:"883"};function jt(s,e){return n(),d("svg",Et,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M905.24 97.83C885.45 116.2 460.07 31.41 454.42.32L.77 868.04l905.88 14.13z"},null,-1)]))}const qt={render:jt},Ut={xmlns:"http://www.w3.org/2000/svg",width:"1534",height:"1090"};function Vt(s,e){return n(),d("svg",Ut,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M1533.77 213.66c-36.75 8.48-247.32-176.64-269.93-213.38L.41 1013.55l1085.36 76.32z"},null,-1)]))}const Xt={render:Vt},Nt={xmlns:"http://www.w3.org/2000/svg",width:"1168",height:"607"};function Yt(s,e){return n(),d("svg",Nt,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M1018.02 143.13C931.81 234.99 338.25 155.85 259.11.39L120.62 99.32C151.71 157.26 20.28 273.14.49 287.28c244.49 340.57 871.96 392.86 1167.33 230.34-29.68-57.94-171-207.73-105.99-262.85z"},null,-1)]))}const Kt={render:Yt},Wt={xmlns:"http://www.w3.org/2000/svg",width:"1625",height:"1329"};function Zt(s,e){return n(),d("svg",Wt,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M1624.11 171.31c-3.45 16.97-138.61-156.52-135.67-171L.31 603.75l193.61 724.98z"},null,-1)]))}const Jt={render:Zt},Qt={xmlns:"http://www.w3.org/2000/svg",width:"1492",height:"821"};function en(s,e){return n(),d("svg",Qt,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M1491.85 246.31c-12.56 6.09-84.79-230.36-87.62-245.9L.9 181.3l48.05 638.77z"},null,-1)]))}const tn={render:en},nn={xmlns:"http://www.w3.org/2000/svg",width:"1432",height:"597"};function sn(s,e){return n(),d("svg",nn,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M1431.89 418.82c-10.34 1.6-17.4-199.52-9.9-200.68-42.39 2.83-254.38-29.68-319.39-80.55L7.35.5.29 596.89z"},null,-1)]))}const on={render:sn},rn={xmlns:"http://www.w3.org/2000/svg",width:"571",height:"629"};function an(s,e){return n(),d("svg",rn,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M570.53 420.56c-63.6-39.57-155.46-329.28-125.78-402.77L314.73.83C224.28 50.3 40.56 27.69 2.41 14.97c-12.72 145.56 21.2 428.21 224.7 613.34 29.68-15.55 132.84-127.19 204.92-108.82z"},null,-1)]))}const ln={render:an},un={xmlns:"http://www.w3.org/2000/svg",width:"1432",height:"799"};function dn(s,e){return n(),d("svg",un,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M1370.86 777.8c-9.38.35 54.91-210.35 60.77-210.57L.03.52l36.74 664.22L1065.6 799c46.64-40.98 223.29-36.74 305.26-21.2"},null,-1)]))}const cn={render:dn},pn={xmlns:"http://www.w3.org/2000/svg",width:"1695",height:"1280"};function mn(s,e){return n(),d("svg",pn,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M1512.63 1279.82c-11.3-29.68 154.04-245.91 182.31-262.86L441.4.84.48 683.43z"},null,-1)]))}const fn={render:mn},gn={xmlns:"http://www.w3.org/2000/svg",width:"1433",height:"1089"};function vn(s,e){return n(),d("svg",gn,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M1200.35 1088.78c5.31-21.04 196.44-161.11 231.77-166.76L897.92.6.52 110.83z"},null,-1)]))}const yn={render:vn},hn={xmlns:"http://www.w3.org/2000/svg",width:"755",height:"752"};function wn(s,e){return n(),d("svg",hn,e[0]||(e[0]=[v("path",{fill:"transparent",d:"M.04 648.04C25.47 448.78 214.85 119.49 489.01.78c107.41 33.92-72.07 189.37 180.9 183.72l84.79 141.32c-86.21 26.86-282.65 336.35-292.54 425.39l-130.02-18.38c11.31-40.98-285.47-77.72-332.1-84.79"},null,-1)]))}const $n={render:wn},_n={"1A":ot,"1C":at,"1H":dt,"1G":mt,"2A":vt,"2C":wt,"2H":Ct,"2G":Pt,"3A":bt,"3C":At,"3H":Gt,"3G":Rt,"4A":Tt,"4C":qt,"4H":Xt,"4G":Kt,"5A":Jt,"5C":tn,"5H":on,"5G":ln,"6A":cn,"6C":fn,"6H":yn,"6G":$n},Cn=F({props:{position:{type:Object,required:!0,default(){return{x:0,y:0}}},systemConfig:{type:Object,required:!0}},emits:["click","mounted"],setup(s,{emit:e,attrs:f}){var c;const g=(c=_n[s.systemConfig.id])==null?void 0:c.render(),h=L(),x=L(),M=L(),k=L(),G=function(y){e("click",s.systemConfig.id,y)};Fe(()=>{e("mounted",{el:M.value??h.value,shape:x.value,bounds:k.value})});const z=()=>{var y;return T(g.type,{...g.props,ref:h,...f,style:{pointerEvents:"none",scale:s.systemConfig.scale,left:`${s.systemConfig.position.x}px`,top:`${s.systemConfig.position.y}px`,transformOrigin:"center",transform:"translate(-50%, -50%)"},"data-system-id":s.systemConfig.id},(y=g.children)==null?void 0:y.map(l=>T(l.type,{ref:x,style:{pointerEvents:"all"},"data-path-system-id":s.systemConfig.id,onClick:p=>{G(p)},...l.props})))};return s.systemConfig.bounds?()=>{var y;return[T(g.type,{...g.props,ref:M,...f,style:{pointerEvents:"none",scale:s.systemConfig.scale*s.systemConfig.bounds.scale,left:`${s.systemConfig.position.x}px`,top:`${s.systemConfig.position.y}px`,transform:`translate(-${s.systemConfig.bounds.position.x}px, -${s.systemConfig.bounds.position.y}px) translate(-50%, -50%)`},"data-system-id":`${s.systemConfig.id}-bounds`},(y=g.children)==null?void 0:y.map(l=>T(l.type,{ref:k,style:{pointerEvents:"all"},...l.props}))),T(z)]}:z}}),Sn=["src","alt"],xn=F({__name:"GameSystemMenu",props:{activeSystem:{},pointerPosition:{}},emits:["select","close"],setup(s,{emit:e}){const f=s,g=e,h=Re(),x=A(()=>h.players.length>0?h.players.map(c=>c.color):Object.values(E).filter(c=>c!==E.free&&c!==E.empire)),M=x.value.concat(E.free),k=x.value.concat(E.empire),G=A(()=>({left:`${f.pointerPosition.x}px`,top:`${f.pointerPosition.y}px`}));function z(c,y){g("select",c,y)}return(c,y)=>(n(),S(t(_e),{"default-open":!0,modal:!1,"onUpdate:open":y[4]||(y[4]=l=>g("close"))},{default:r(()=>[a(t(he),{class:"fixed dropdown-trigger",style:te(G.value)},null,8,["style"]),a(t($e),null,{default:r(()=>[a(t(Ce),{options:{ignore:[".system-dialog"]},onTrigger:y[3]||(y[3]=l=>g("close"))},{default:r(()=>[a(t(we),null,{default:r(()=>[w($(c.$t("system_id",{id:c.activeSystem})),1)]),_:1}),a(t(J)),a(t(j),null,{default:r(()=>[a(t(q),null,{default:r(()=>[w($(c.$t("system_menu.add_ship")),1)]),_:1}),a(t(U),null,{default:r(()=>[(n(!0),d(D,null,R(t(k),l=>(n(),S(t(b),{key:l,onSelect:p=>z(t(Z).ship,l)},{default:r(()=>[w($(c.$t(`colors.${l}`)),1)]),_:2},1032,["onSelect"]))),128))]),_:1})]),_:1}),a(t(j),null,{default:r(()=>[a(t(q),null,{default:r(()=>[w($(c.$t("system_menu.add_flagship")),1)]),_:1}),a(t(U),null,{default:r(()=>[(n(!0),d(D,null,R(x.value,l=>(n(),S(t(b),{key:l,onSelect:p=>z(t(Z).flagship,l)},{default:r(()=>[w($(c.$t(`colors.${l}`)),1)]),_:2},1032,["onSelect"]))),128))]),_:1})]),_:1}),a(t(j),null,{default:r(()=>[a(t(q),{class:"data-[disabled]:opacity-50"},{default:r(()=>[w($(c.$t("system_menu.add_city")),1)]),_:1}),a(t(U),null,{default:r(()=>[(n(!0),d(D,null,R(t(M),l=>(n(),S(t(b),{key:l,onSelect:p=>z(t(le).city,l)},{default:r(()=>[w($(c.$t(`colors.${l}`)),1)]),_:2},1032,["onSelect"]))),128))]),_:1})]),_:1}),a(t(j),null,{default:r(()=>[a(t(q),{class:"data-[disabled]:opacity-50"},{default:r(()=>[w($(c.$t("system_menu.add_starport")),1)]),_:1}),a(t(U),null,{default:r(()=>[(n(!0),d(D,null,R(t(M),l=>(n(),S(t(b),{key:l,onSelect:p=>z(t(le).starport,l)},{default:r(()=>[w($(c.$t(`colors.${l}`)),1)]),_:2},1032,["onSelect"]))),128))]),_:1})]),_:1}),a(t(j),null,{default:r(()=>[a(t(q),null,{default:r(()=>[w($(c.$t("system_menu.add_token")),1)]),_:1}),a(t(U),null,{default:r(()=>[(n(!0),d(D,null,R(t(Ie),l=>(n(),S(t(b),{key:l,onSelect:p=>z(l)},{default:r(()=>[v("img",{src:`./images/tokens/${l.toLowerCase()}.png`,alt:l,class:"h-6 mr-2"},null,8,Sn),w(" "+$(c.$t(`pieces.${l}`)),1)]),_:2},1032,["onSelect"]))),128))]),_:1})]),_:1}),a(t(J)),a(Je,{"system-id":c.activeSystem,onClose:y[1]||(y[1]=l=>c.$emit("close")),onConfirm:y[2]||(y[2]=l=>c.$emit("close"))},{default:r(()=>[a(t(b),{onSelect:y[0]||(y[0]=ve(()=>{},["prevent"]))},{default:r(()=>[w($(c.$t("system_menu.configure")),1)]),_:1})]),_:1},8,["system-id"])]),_:1})]),_:1})]),_:1}))}}),Pn=ye(xn,[["__scopeId","data-v-bdbc94e6"]]),Mn=F({__name:"GamePieceMenu",props:{activePiece:{},pointerPosition:{}},emits:["add","remove","flip","preview","close"],setup(s,{emit:e}){const f=s,g=e,{t:h}=He(),x=A(()=>({left:`${f.pointerPosition.x}px`,top:`${f.pointerPosition.y}px`})),M=A(()=>{const p=h(`colors.${f.activePiece.color}`),m=h(`pieces.${f.activePiece.type}`,"group"in f.activePiece?2:1),_=f.activePiece.color?`${p} ${m}`:m;return`${_.charAt(0).toUpperCase()}${_.slice(1).toLowerCase()}`}),k=A(()=>"group"in f.activePiece?f.activePiece.group.fresh.length>0:f.activePiece.isFresh),G=A(()=>"group"in f.activePiece?f.activePiece.group.damaged.length>0:!f.activePiece.isFresh);function z(){f.activePiece.color?g("add",f.activePiece.type,f.activePiece.color):g("add",f.activePiece.type)}function c(p=!0){g("remove",p)}function y(p=!0){g("flip",p)}function l(){g("preview")}return(p,m)=>(n(),S(t(_e),{"default-open":!0,modal:!1,"onUpdate:open":m[8]||(m[8]=_=>g("close"))},{default:r(()=>[a(t(he),{class:"fixed dropdown-trigger",style:te(x.value)},null,8,["style"]),a(t($e),null,{default:r(()=>[a(t(Ce),{onTrigger:m[7]||(m[7]=_=>g("close"))},{default:r(()=>[a(t(we),null,{default:r(()=>[w($(M.value),1)]),_:1}),a(t(J)),"group"in p.activePiece?(n(),d(D,{key:0},[a(t(b),{onSelect:z},{default:r(()=>[a(t(W),{class:"mr-2",size:16}),w(" "+$(p.$t("piece_menu.add")),1)]),_:1}),k.value?(n(),S(t(b),{key:0,onSelect:m[0]||(m[0]=_=>y(!0))},{default:r(()=>[a(t(W),{class:"mr-2",size:16}),w(" "+$(p.$t("piece_menu.damage_fresh")),1)]),_:1})):O("",!0),k.value?(n(),S(t(b),{key:1,onSelect:m[1]||(m[1]=_=>c(!0))},{default:r(()=>[a(t(W),{class:"mr-2",size:16}),w(" "+$(p.$t("piece_menu.remove_fresh")),1)]),_:1})):O("",!0),G.value?(n(),S(t(b),{key:2,onSelect:m[2]||(m[2]=_=>y(!1))},{default:r(()=>[a(t(ce),{class:"mr-2",size:16}),w(" "+$(p.$t("piece_menu.repair_damaged")),1)]),_:1})):O("",!0),G.value?(n(),S(t(b),{key:3,onSelect:m[3]||(m[3]=_=>c(!1))},{default:r(()=>[a(t(ce),{class:"mr-2",size:16}),w(" "+$(p.$t("piece_menu.remove_damaged")),1)]),_:1})):O("",!0)],64)):(n(),d(D,{key:1},[t(ue)(p.activePiece.type)?O("",!0):(n(),S(t(b),{key:0,onSelect:m[4]||(m[4]=_=>y(p.activePiece.isFresh))},{default:r(()=>[w($(p.activePiece.isFresh?p.$t("piece_menu.damage"):p.$t("piece_menu.repair")),1)]),_:1})),t(ue)(p.activePiece.type)?(n(),S(t(b),{key:1,onSelect:m[5]||(m[5]=_=>l())},{default:r(()=>[w($(p.$t("common.view")),1)]),_:1})):O("",!0),a(t(b),{onSelect:m[6]||(m[6]=_=>c(p.activePiece.isFresh))},{default:r(()=>[w($(p.$t("piece_menu.remove")),1)]),_:1})],64))]),_:1})]),_:1})]),_:1}))}}),kn=ye(Mn,[["__scopeId","data-v-38ffbd9a"]]),bn=["src"],zn={class:"space-y-1 map-controls"},Ln=F({__name:"GameBoard",setup(s){const e=Te();Ee().pause();const g=L(),h=L({x:0,y:0}),x=L(new Image);x.value.src=pe;const M=je({width:0,height:0}),k=L(),G=A(()=>({transformOrigin:"top left",scale:e.mapScale,width:M.width*e.mapScale,height:M.height*e.mapScale}));function z(u,o){var P;const i=(P=k.value)==null?void 0:P.getBoundingClientRect();u.position.x=o.clientX/e.mapScale-h.value.x+i.x/e.mapScale*-1,u.position.y=o.clientY/e.mapScale-h.value.y+i.y/e.mapScale*-1}function c(u,o){var P;if(!o)return;const i=(P=k.value)==null?void 0:P.getBoundingClientRect();u.position.x=o.clientX/e.mapScale-h.value.x+i.x/e.mapScale*-1,u.position.y=o.clientY/e.mapScale-h.value.y+i.y/e.mapScale*-1,g.value=void 0}function y(u,o){var P;const i=(P=o.target)==null?void 0:P.getBoundingClientRect();g.value=u,h.value={x:o.clientX-i.x-i.width/2*e.mapScale,y:o.clientY-i.y-i.height/2*e.mapScale}}function l(){M.height=x.value.height,M.width=x.value.width}function p(u){e.mapScale+=u,e.mapScale<.3?e.mapScale=.3:e.mapScale>2&&(e.mapScale=2)}const m=L(),_=L(),Se=A(()=>m.value?B.systemUi(m.value,"position"):void 0);function xe(u,o){m.value=u,e.updateMenu({type:I.System,id:u,position:{x:o.clientX,y:o.clientY}})}function ne(u){m.value=void 0,_.value=void 0,V.value=-1,setTimeout(()=>{e.updateMenu({isOpen:!1})},100)}const Pe=L(!0),B=qe(),Me=A(()=>{if(!Pe.value)return B.pieces;const u=new Map;return B.pieces.forEach(o=>{const i=`${o.system} ${o.color} ${o.type}`;if(Ne(o.type)||o.type===Z.flagship||Ye(o.type)&&Ke(o.type)){u.set(i+o.id,o);return}const P=["system","type","color","position"];u.has(i)||u.set(i,de.transform(o,(N,Y,H)=>{P.includes(H)&&(N[H]=Y)},{group:{damaged:[],fresh:[]}}));const C=["id","isFresh"],ae=u.get(i),X=de.transform(o,(N,Y,H)=>{C.includes(H)&&(N[H]=Y)},{isFresh:!0});X.isFresh?ae.group.fresh.push(X):ae.group.damaged.push(X)}),Array.from(u.values())});function se(u,o,i){_.value=u,V.value=o,m.value=u.system,e.updateMenu({type:I.Piece,id:o,position:{x:i.clientX,y:i.clientY}})}function oe(u,o){if(!m.value)return;let{x:i,y:P}=k.value.getBoundingClientRect();B.addPiece(m.value,{type:u,color:o},{x:e.currentMenu.position.x/e.mapScale-i/e.mapScale,y:e.currentMenu.position.y/e.mapScale-P/e.mapScale})}function ke(u){_.value&&B.removePiece(_.value,u)}function be(u){_.value&&B.flipPiece(_.value,u)}function ze(u,o){const i=B.systems[o];B.positionPiece(i,u)}function ie(u){g.value&&B.movePiece(g.value,u,g.value.position)}const V=L(-1);function re(u){e.piecePreview=u?V.value:void 0}return(u,o)=>(n(),d(D,null,[v("div",{ref_key:"wrapperEl",ref:k,id:"game-wrapper",class:"select-none",style:te(G.value)},[v("img",{src:t(pe),alt:"Arcs",class:"max-w-max",draggable:"false",onLoad:l},null,40,bn),(n(!0),d(D,null,R(t(Ue),i=>(n(),S(t(Cn),{key:i.id,"system-config":i,position:i.position,class:"absolute system",draggable:"false",onClick:xe,onMounted:P=>t(B).setSystemUi(i.id,P),onDragover:o[0]||(o[0]=ve(()=>{},["prevent","stop"])),onDrop:P=>ie(i.id)},null,8,["system-config","position","onMounted","onDrop"]))),128)),(n(!0),d(D,null,R(Me.value,(i,P)=>(n(),S(We,{key:`${i.type}${i.color?`-${i.color}`:""}-${i.system}`,"piece-config":i,"system-position":Se.value,"open-preview":t(e).piecePreview===P,draggable:"false",onReposition:C=>ze(i,C),onClick:C=>se(i,P,C),onPreviewClose:o[1]||(o[1]=C=>re(!1)),onDragstart:C=>y(i,C),onDragend:C=>c(i,C),onPressClick:C=>se(i,P,C),onPressStart:C=>y(i,C),onPressMove:C=>z(i,C),onPressEnd:C=>c(i,C),onPressDrop:o[2]||(o[2]=C=>ie(C))},null,8,["piece-config","system-position","open-preview","onReposition","onClick","onDragstart","onDragend","onPressClick","onPressStart","onPressMove","onPressEnd"]))),128))],4),v("div",zn,[a(t(K),{size:"icon",onClick:o[3]||(o[3]=i=>p(.1))},{default:r(()=>[a(t(et))]),_:1}),a(t(K),{size:"icon",onClick:o[4]||(o[4]=i=>p(-.1))},{default:r(()=>[a(t(tt))]),_:1}),a(t(Xe),{to:{name:"campaign",query:{screen:t(Ve).Map}},custom:""},{default:r(({navigate:i})=>[a(t(K),{size:"icon",onClick:i},{default:r(()=>[a(t(Qe))]),_:2},1032,["onClick"])]),_:1},8,["to"])]),m.value&&t(e).currentMenu.type===t(I).System?(n(),S(Pn,{key:0,"active-system":m.value,"pointer-position":t(e).currentMenu.position,onSelect:oe,onClose:o[5]||(o[5]=i=>ne(t(I).System))},null,8,["active-system","pointer-position"])):O("",!0),_.value&&t(e).currentMenu.type===t(I).Piece?(n(),S(kn,{key:1,"active-piece":_.value,"pointer-position":t(e).currentMenu.position,onAdd:oe,onRemove:ke,onFlip:be,onPreview:o[6]||(o[6]=i=>re(!0)),onClose:o[7]||(o[7]=i=>ne(t(I).Piece))},null,8,["active-piece","pointer-position"])):O("",!0)],64))}}),An={class:"relative viewport"},On=F({__name:"CampaignView",setup(s){return(e,f)=>(n(),d("main",An,[a(Ln)]))}});export{On as default};
